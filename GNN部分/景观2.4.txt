Wang在2011年的论文Quantifying the Waddington landscape and biological paths for development and differentiation中首次实现了量化的沃丁顿景观模型，并且将细胞在沃丁顿景观中的受力分解成了梯度力（保守）和卷积力（非保守），分别表示细胞分化的方向和迂回震荡路径（可能是反馈环路导致），但这个方法得到的两个力都是基于微分方程，改变微分方程的参数来模拟发育的过程，所以只能用于比较简单的系统，比如只有两个转录因子调控的过程，对于EMT这种调控复杂的过程难以运用。我们以EMT过程为例，尝试采用数据收集的方法，绕开微分方程，以观察到的细胞的某个时间点（我们用伪时间赋予时间）的频率密度分布得到概率密度分布，从而得到细胞在EMT过程中细胞的RNA表达状态的概率密度随时间变化的函数P（X，t），然后用FP方程的概率密度扩散过程来更简洁地描述这个概率密度随时间变化的过程，通过得到的μ和D两个参数得到细胞在某个状态时可能的分化方向和处在这个状态的异质性、稳定性。

一、收集数据和处理：
1，收集足够的乳腺癌样本（要有一定量的正常人的样本），利用GNN提取EMT过程1的关键基因以及MLR算法所需要的所有基因，清洗
2，对所有样本进行MLR评分，并作为标签
3，对样本进行降维，monocle3分析并赋予伪时间，以MLR评分作为依照（比如按照MLR评分的某个点为起点）
4，增减选中的基因，直到伪时间与MLR得分的相关性达到一个比较高的水平且不再有太大变化
此时得到monocle3降维和赋予伪时间后的图

二、构建概率景观
按照文章的描述，构建的是一个空间的的连续概率分布，以及这个概率分布随时间的变化，我们需要根据散点和时间戳构建这个
1，将时间戳分段，某一个时间窗口内的时间整合为一组，赋予一个相同的时间
2，把每个赋予了新时间戳的高维散点情况给MDN进行学习，得到这个时间点的多组权重，均值，方差
3，将多组方差权重随时间变化曲线拟合，得到P（X，t），X是坐标

三、构建FP方程
以Fokker-Planck方程\frac{\partial P}{\partial t}=-\nabla\cdot[\mu(x,y)P]+\nabla\cdot[D(x,y)\nabla P]成立，概率和为1等为约束条件，求\min_{\mu,D} \iint \left(1-\frac{\mu(x,y)\cdot\nabla M(x,y)}{|\mu(x,y)||\nabla M(x,y)|}\right)^2 dxdy这个最小化问题，得到μ（x，y）和D（x，y）

应用前景：
μ的意义：
每个点(x,y)代表一个特定的基因表达状态（因为x,y是mRNA表达谱的降维结果）
在每个状态点，μ给出一个向量，这个向量：

方向表示基因表达模式倾向于改变的方向
大小表示这种改变的快慢


整个向量场描绘了EMT过程中基因表达变化的"路径图"：

某些区域的向量可能指向间质状态
其他区域可能指向上皮状态
向量的大小告诉我们哪些区域转换快，哪些区域转换慢

D的意义：
D(x,y)作为标量场：

在每个基因表达状态点给出一个数值，表示该状态下的随机波动程度
较大的D值意味着：

该表达状态不稳定
细胞可能更容易偏离当前的表达模式
表现出更高的表达异质性


较小的D值表示：

该表达状态相对稳定
细胞倾向于维持当前的表达模式
表达模式比较一致

这两个场的组合描述了EMT过程的完整动态特征：

μ告诉我们细胞"想要"往哪个方向转变
D告诉我们细胞在这个转变过程中有多"犹豫"或"坚定"

目前已经有的研究：
https://www.biorxiv.org/content/10.1101/2024.11.16.623974v1.full.pdf
这个构建了一个Squidiff深度学习模型来预测分化轨迹
劣势：我们没有用扩散模型来进行深度学习，获取非线性特征的能力或许不如Squidiff强
Squidiff扩展性很强，现在已用于多个发育领域
我们的研究可能的优势：
算力要求可能会更小，Squidiff有个训练集好像就用了80G内存
我们用概率来描述一个细胞的过程，可能会比Squidiff的生成散点和噪声有更好的效果，更贴近实际
